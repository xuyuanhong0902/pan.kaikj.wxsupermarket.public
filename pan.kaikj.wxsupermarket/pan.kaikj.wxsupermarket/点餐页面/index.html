<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <title>茶部落</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/amazeui.min.js" type="text/javascript"></script>
    <link href="css/amazeui.min.css" type="text/css" rel="stylesheet" />
    <link href="css/style.css" type="text/css" rel="stylesheet" />
</head>
<body>
    <header data-am-widget="header" class="am-header am-header-default sq-head ">
        <div class="am-header-right am-header-nav">
                <a href="takeout.html">
                    <i class="">
                        <img style="height:35px;" src="images/shopCart.png" />
                    </i>
                </a>
        </div>
    </header>
    <div class="content-list" id="outer">
        <div class="list-left" id="tab">
            <!--<li><a style="position: relative;">新品推荐<i class="num">8</i></a></li>-->
            <ul>
                <li data-typeId="1"><a>芝士奶盖系列</a></li>
                <li data-typeId="2"><a>精选奶茶</a></li>
                <li data-typeId="3"><a>部落奶盐</a></li>
                <li data-typeId="4"><a>正宗可可奶盖</a></li>
                <li data-typeId="5"><a>清新果茶</a></li>
                <li data-typeId="6"><a>招牌榴莲奶盖</a></li>
                <li data-typeId="7"><a>部落奶盖系列</a></li>
            </ul>
        </div>
        <div class="list-right" id="content">
            <ul class="list-pro proListType1" data-hasPro="0">
                <li>
                    <a href="detail.html"><img src="images/1.png" class="list-pic" /></a>
                    <div class="shop-list-mid" data-id="1">
                        <div class="tit"><a href="detail.html">法国加力果12个装 进口新鲜水果 嘎啦苹果 包邮</a></div>
                        <div class="am-gallery-desc">￥<label class="price">66</label></div>
                    </div>
                    <div class="list-cart">
                        <div class="d-stock ">
                            <a class="decrease">-</a>
                            <input id="num" readonly="" class="text_box" name="" type="text" value="0">
                            <a class="increase">+</a>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="detail.html"><img src="images/2.png" class="list-pic" /></a>
                    <div class="shop-list-mid" data-id="2">
                        <div class="tit"><a href="detail.html">法国加力果12个装 进口新鲜水果 嘎啦苹果 包邮</a></div>
                        <div class="am-gallery-desc">￥<label class="price">22</label></div>
                    </div>
                    <div class="list-cart">
                        <div class="d-stock ">
                            <a class="decrease">-</a>
                            <input id="num" readonly="" class="text_box" name="" type="text" value="0">
                            <a class="increase">+</a>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="detail.html"><img src="images/1.png" class="list-pic" /></a>
                    <div class="shop-list-mid" data-id="3">
                        <div class="tit"><a href="detail.html">法国加力果12个装 进口新鲜水果 嘎啦苹果 包邮</a></div>
                        <div class="am-gallery-desc">￥<label class="price">33</label></div>
                    </div>
                    <div class="list-cart">
                        <div class="d-stock ">
                            <a class="decrease">-</a>
                            <input id="num" readonly="" class="text_box" name="" type="text" value="0">
                            <a class="increase">+</a>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="detail.html"><img src="images/2.png" class="list-pic" /></a>
                    <div class="shop-list-mid" data-id="3">
                        <div class="tit"><a href="detail.html">法国加力果12个装 进口新鲜水果 嘎啦苹果 包邮</a></div>
                        <div class="am-gallery-desc">￥<label class="price">66</label></div>
                    </div>
                    <div class="list-cart">
                        <div class="d-stock ">
                            <a class="decrease">-</a>
                            <input id="num" readonly="" class="text_box" name="" type="text" value="0">
                            <a class="increase">+</a>
                        </div>
                    </div>
                </li>
            </ul>
            <ul class="list-pro proListType2" data-hasPro="1" data-pagIndex="4">
                <li>
                    <a href="detail.html"><img src="images/1.png" class="list-pic" /></a>
                    <div class="shop-list-mid" data-id="4">
                        <div class="tit"><a href="detail.html">法国21加力果12个装 进口新鲜水果 嘎啦苹果 包邮</a></div>
                        <div class="am-gallery-desc">￥<label class="price">66</label></div>
                    </div>
                    <div class="list-cart">
                        <div class="d-stock ">
                            <a class="decrease">-</a>
                            <input id="num" readonly="" class="text_box" name="" type="text" value="0">
                            <a class="increase">+</a>
                        </div>
                    </div>
                </li>
            </ul>
            <ul class="list-pro proListType3" data-hasPro="1" data-pagIndex="1">
                <li>
                    <a href="detail.html"><img src="images/1.png" class="list-pic" /></a>
                    <div class="shop-list-mid" data-id="4">
                        <div class="tit"><a href="detail.html">法国加力果12个装 进口新鲜水果 嘎啦苹果 包邮</a></div>
                        <div class="am-gallery-desc">￥<label class="price">11</label></div>
                    </div>
                    <div class="list-cart">
                        <div class="d-stock ">
                            <a class="decrease">-</a>
                            <input id="num" readonly="" class="text_box" name="" type="text" value="0">
                            <a class="increase">+</a>
                        </div>
                    </div>
                </li>
            </ul>
            <ul class="list-pro proListType4" data-hasPro="0">
                <li>
                    <span style="font-size:12px;color:#0094ff;">未获取到商品数据</span>
                </li>
            </ul>
        </div>
    </div>
    <!--底部-->
    <div style="height: 100px;"></div>
    <div class="fix-bot">
        <a href="" class="list-js">
            合计：
            <i><label id="totalPrice">0</label>元</i><em>(<label id="totalNum">0</label>份)</em>
        </a>
        <a href="#" id="submit" class="list-jsk">选好了</a>
    </div>

    <div class="am-modal am-modal-confirm" tabindex="-1" id="my-confirm">
        <div class="am-modal-dialog">
            <div class="am-modal-bd" style="height: 80px; line-height: 80px;">  您确定要清空饮品吗？</div>
            <div class="am-modal-footer">
                <span class="am-modal-btn" data-am-modal-cancel>取消</span>
                <span class="am-modal-btn" data-am-modal-confirm>确定</span>
            </div>
        </div>
    </div>

    <script>
        var hasSelProId = new Array();
        //购物数量加减
        $(function () {
            $('.increase').click(function () {
                //// 数量加1
                var self = $(this);
                var current_num = parseInt(self.siblings('input').val());
                current_num += 1;
                if (current_num > 0) {
                    self.siblings(".decrease").fadeIn();
                    self.siblings(".text_box").fadeIn();
                }
                self.siblings('input').val(current_num);

                //// 购物车数量展示处理
                update_item(self, 1);
            })
            $('.decrease').click(function () {
                //// 数量减1
                var self = $(this);
                var current_num = parseInt(self.siblings('input').val());
                if (current_num > 0) {
                    current_num -= 1;
                    if (current_num < 1) {
                        self.fadeOut();
                        self.siblings(".text_box").fadeOut();
                    }
                    self.siblings('input').val(current_num);

                    //// 购物车数量展示处理
                    update_item(self, 0);
                }
            })
        })

        //删除提示信息
        $(function () {
            $('#doc-modal-list').find('.am-icon-close').add('#doc-confirm-toggle').
                on('click', function () {
                    $('#my-confirm').modal({
                        relatedTarget: this,
                        onConfirm: function (options) {
                            var $link = $(this.relatedTarget).prev('a');
                            var msg = $link.length ? '你要删除的饮品 为 ' + $link.data('id') :
                                '确定了';
                            //        alert(msg);
                        },
                        onCancel: function () {
                            alert('不删除');
                        }
                    });
                });
        });

        //tab切换
        $(function () {
            window.onload = function () {
                var $li = $('#tab li');
                var $ul = $('#content ul');
                $li.click(function () {
                    var $this = $(this);
                    getPro($this);
                });

                //// 获取产品列表数据
                function getPro($this) {
                    var $seleType = $this.attr("data-typeId");
                    $li.removeClass();
                    $this.addClass('current');
                    $ul.css('display', 'none');
                    var $selProCount = $(".proListType" + $seleType);
                    $selProCount.css('display', 'block');

                    //// 查找是否是否还有数据标识
                    var hasPro = $selProCount.attr("data-hasPro");
                    if (hasPro != "0") {
                        ///// 获取当前数据所显示的页码
                        var pagIndex = parseInt($selProCount.attr("data-pagIndex"));
                        if (!pagIndex) {
                            pagIndex = 0;
                        }
                        ///// alert("开始获取类型为" + $seleType+"第" + (pagIndex+1)+"页数据");
                    }
                }

                //// 初始化加载第一个类别数据
                $li.first().addClass("current");
                getPro($li.first());
            }
        });

        //// 选好了单击事件
        $(function () {
            $('#submit').click(function () {
                if (hasSelProId.length<1) {
                    alert("请选中需要的产品！");
                    return;
                }
                window.location.href = 'takeout.html';
            });
        });

        //// 选择商品总价显示
        function update_item(self, opertType) {
            //// 购物车数量展示处理
            var totalPrice = parseFloat($("#totalPrice").html().trim());
            var totalNum = parseInt($("#totalNum").html().trim());
            var thisPrice = parseFloat(self.parent().parent().prev().children().find(".price").html().trim());

            hasSelProId.push(self.parent().parent().prev().attr("data-id"));

            totalPrice = opertType == 1 ? totalPrice + thisPrice : totalPrice - thisPrice;
            totalNum = opertType == 1 ? totalNum + 1 : totalNum - 1;
            $("#totalPrice").html(totalPrice.toFixed(2));
            $("#totalNum").html(totalNum)
        }
    </script>
</body>
</html>
